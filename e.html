<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Electrical Calculator</title>
    <style>
        :root {
            --primary: #0056b3;
            --dark: #1a1a1a;
            --light: #f4f4f9;
            --white: #ffffff;
            --gray: #ccc;
            --radius: 8px;
            --shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--light);
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        /* HEADER */
        header {
            margin-top: 40px;
            margin-bottom: 20px;
            text-align: center;
        }

        h1 {
            font-size: 48px;
            color: var(--dark);
            margin: 0;
            font-weight: 700;
            letter-spacing: -1px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            padding: 20px;
            flex: 1;
        }

        /* SYSTEM SELECTOR (3 Columns) */
        .system-selector {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 10px;
            margin-bottom: 30px;
            background: var(--white);
            padding: 5px;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
        }

        .sys-btn {
            padding: 15px;
            border: none;
            background: transparent;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            color: #666;
            border-radius: var(--radius);
            transition: all 0.3s ease;
        }

        .sys-btn:hover {
            background-color: #eef;
        }

        .sys-btn.active {
            background-color: var(--primary);
            color: var(--white);
        }

        /* POWER FACTOR (AC Only) */
        .pf-container {
            display: none; /* Hidden by default for DC */
            text-align: center;
            margin-bottom: 20px;
        }
        
        .pf-container label {
            font-weight: 600;
            margin-right: 10px;
        }

        .pf-container input {
            padding: 8px;
            border-radius: 4px;
            border: 1px solid var(--gray);
            width: 80px;
            text-align: center;
        }

        /* MAIN CALCULATOR GRID (4 Columns) */
        .calc-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-bottom: 40px;
        }

        @media (max-width: 768px) {
            .calc-grid {
                grid-template-columns: 1fr; /* Stack on mobile */
            }
            .system-selector {
                grid-template-columns: 1fr;
            }
        }

        /* CARDS */
        .card {
            background: var(--white);
            padding: 20px;
            border-radius: var(--radius);
            box-shadow: var(--shadow);
            display: flex;
            flex-direction: column;
            gap: 10px;
            border-top: 4px solid var(--primary);
        }

        .card.result {
            border-top: 4px solid #28a745; /* Green for results */
            background-color: #fdfdfd;
        }

        .label-text {
            font-size: 14px;
            color: #666;
            font-weight: 600;
            text-transform: uppercase;
        }

        select, input {
            width: 100%;
            padding: 12px;
            font-size: 16px;
            border: 1px solid var(--gray);
            border-radius: 4px;
            box-sizing: border-box;
        }

        input:focus, select:focus {
            outline: none;
            border-color: var(--primary);
        }

        .value-display {
            font-size: 24px;
            font-weight: bold;
            color: var(--dark);
            padding: 10px 0;
            word-break: break-all;
        }

        .unit {
            font-size: 14px;
            color: #888;
        }

        /* FOOTER */
        footer {
            text-align: center;
            padding: 40px;
            background-color: var(--white);
            margin-top: auto;
            border-top: 1px solid #eee;
        }

        footer p {
            margin: 0;
            font-size: 18px;
            color: #555;
            font-weight: 500;
        }

    </style>
</head>
<body>

    <header>
        <h1>Calculator</h1>
    </header>

    <div class="container">
        
        <div class="system-selector">
            <button class="sys-btn active" onclick="setSystem('dc')">DC (Direct Current)</button>
            <button class="sys-btn" onclick="setSystem('ac1')">Single Phase AC</button>
            <button class="sys-btn" onclick="setSystem('ac3')">Three Phase AC</button>
        </div>

        <div class="pf-container" id="pfBox">
            <label for="powerFactor">Power Factor (Cos θ):</label>
            <input type="number" id="powerFactor" value="0.8" step="0.1" min="0" max="1" oninput="calculate()">
            <small style="display:block; color:#666; margin-top:5px;">(Value between 0 and 1)</small>
        </div>

        <div class="calc-grid">
            
            <div class="card">
                <span class="label-text">Input Parameter 1</span>
                <select id="type1" onchange="handleTypeChange(1)">
                    <option value="p">Power (P)</option>
                    <option value="v" selected>Voltage (V)</option>
                    <option value="i">Current (I)</option>
                    <option value="r">Resistance/Impedance (R/Z)</option>
                </select>
                <input type="number" id="val1" placeholder="Enter value..." oninput="calculate()">
            </div>

            <div class="card">
                <span class="label-text">Input Parameter 2</span>
                <select id="type2" onchange="handleTypeChange(2)">
                    <option value="p">Power (P)</option>
                    <option value="v">Voltage (V)</option>
                    <option value="i" selected>Current (I)</option>
                    <option value="r">Resistance/Impedance (R/Z)</option>
                </select>
                <input type="number" id="val2" placeholder="Enter value..." oninput="calculate()">
            </div>

            <div class="card result">
                <span class="label-text" id="label3">Result 1</span>
                <div class="value-display" id="res3">---</div>
                <span class="unit" id="unit3"></span>
            </div>

            <div class="card result">
                <span class="label-text" id="label4">Result 2</span>
                <div class="value-display" id="res4">---</div>
                <span class="unit" id="unit4"></span>
            </div>

        </div>
    </div>

    <footer>
        <p>Thank you for coming</p>
    </footer>

    <script>
        // State
        let currentSystem = 'dc';
        const types = ['p', 'v', 'i', 'r'];
        const units = {
            'p': 'Watts (W)',
            'v': 'Volts (V)',
            'i': 'Amperes (A)',
            'r': 'Ohms (Ω)'
        };
        const labels = {
            'p': 'Power (P)',
            'v': 'Voltage (V)',
            'i': 'Current (I)',
            'r': 'Resistance (R)'
        };

        // --- Setup UI Logic ---

        function setSystem(sys) {
            currentSystem = sys;
            
            // Update Buttons
            document.querySelectorAll('.sys-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');

            // Show/Hide Power Factor
            const pfBox = document.getElementById('pfBox');
            if (sys === 'dc') {
                pfBox.style.display = 'none';
                labels['r'] = 'Resistance (R)';
            } else {
                pfBox.style.display = 'block';
                labels['r'] = 'Impedance (Z)';
            }

            // Refresh dropdown labels
            updateDropdownLabels();
            calculate();
        }

        function updateDropdownLabels() {
            // Update labels inside dropdowns based on R vs Z
            const options = document.querySelectorAll('option[value="r"]');
            options.forEach(opt => {
                opt.text = currentSystem === 'dc' ? 'Resistance (R)' : 'Impedance (Z)';
            });
        }

        function handleTypeChange(changedCol) {
            const t1 = document.getElementById('type1');
            const t2 = document.getElementById('type2');

            // Prevent choosing same type
            if (t1.value === t2.value) {
                // Find a type that isn't taken
                const taken = t1.value;
                const free = types.find(t => t !== taken);
                if (changedCol === 1) t2.value = free;
                else t1.value = free;
            }
            calculate();
        }

        // --- Math Logic ---

        function calculate() {
            const t1 = document.getElementById('type1').value;
            const t2 = document.getElementById('type2').value;
            
            let v1 = parseFloat(document.getElementById('val1').value);
            let v2 = parseFloat(document.getElementById('val2').value);
            let pf = parseFloat(document.getElementById('powerFactor').value) || 0.8; // Default PF

            // Identify remaining types
            const used = [t1, t2];
            const missing = types.filter(t => !used.includes(t));
            
            // Update Labels for Results
            document.getElementById('label3').innerText = labels[missing[0]];
            document.getElementById('unit3').innerText = units[missing[0]];
            document.getElementById('label4').innerText = labels[missing[1]];
            document.getElementById('unit4').innerText = units[missing[1]];

            if (isNaN(v1) || isNaN(v2)) {
                document.getElementById('res3').innerText = "---";
                document.getElementById('res4').innerText = "---";
                return;
            }

            // Map input values to standard variables (P, V, I, R)
            let inputData = {};
            inputData[t1] = v1;
            inputData[t2] = v2;

            let P = inputData['p'];
            let V = inputData['v'];
            let I = inputData['i'];
            let R = inputData['r']; // R or Z

            let calculated = {};

            // --- CALCULATION ENGINE ---
            
            // DC FORMULAS
            if (currentSystem === 'dc') {
                // 1. Given V and I -> Find P, R
                if (V && I) { P = V * I; R = V / I; }
                // 2. Given P and V -> Find I, R
                else if (P && V) { I = P / V; R = (V * V) / P; }
                // 3. Given P and I -> Find V, R
                else if (P && I) { V = P / I; R = P / (I * I); }
                // 4. Given V and R -> Find P, I
                else if (V && R) { I = V / R; P = (V * V) / R; }
                // 5. Given I and R -> Find P, V
                else if (I && R) { V = I * R; P = (I * I) * R; }
                // 6. Given P and R -> Find V, I
                else if (P && R) { V = Math.sqrt(P * R); I = Math.sqrt(P / R); }
            } 
            
            // SINGLE PHASE AC FORMULAS (Uses Cos Theta / PF)
            // P = V * I * PF
            // V = I * Z
            else if (currentSystem === 'ac1') {
                // R here represents Impedance (Z)
                
                if (V && I) { 
                    P = V * I * pf; 
                    R = V / I; 
                }
                else if (P && V) { 
                    // I = P / (V * PF)
                    I = P / (V * pf); 
                    R = V / I; 
                }
                else if (P && I) { 
                    // V = P / (I * PF)
                    V = P / (I * pf); 
                    R = V / I; 
                }
                else if (V && R) { 
                    // R is Z. I = V/Z
                    I = V / R; 
                    P = V * I * pf; 
                }
                else if (I && R) { 
                    // R is Z. V = I*Z
                    V = I * R; 
                    P = V * I * pf; 
                }
                else if (P && R) { 
                    // Harder derived formula: P = I^2 * Z * PF -> I = sqrt(P / (Z * PF))
                    I = Math.sqrt(P / (R * pf));
                    V = I * R;
                }
            }

            // THREE PHASE AC FORMULAS
            // P = sqrt(3) * V * I * PF (Assuming Line Voltage/Current)
            // Z = V_phase / I_phase ... (Simplified for this calc: V = I * Z usually refers to phase, but simple calcs often treat magnitude ratio. 
            // To match the image logic strictly: I = P / (sqrt(3) * V * PF)
            else if (currentSystem === 'ac3') {
                const root3 = Math.sqrt(3);

                if (V && I) {
                    P = root3 * V * I * pf;
                    R = V / (root3 * I); // Approx Z per phase if Star connected V_L / I_L
                }
                else if (P && V) {
                    I = P / (root3 * V * pf);
                    R = V / (root3 * I);
                }
                else if (P && I) {
                    V = P / (root3 * I * pf);
                    R = V / (root3 * I);
                }
                // For the purpose of this calculator based on the image columns:
                // The image doesn't explicitly link Z to Line Values easily without knowing Star/Delta.
                // However, based on column logic, we will infer simple relations or Disable Z for 3-phase if too complex.
                // BUT, to keep UI functional, we will use magnitude V/I ratio for R/Z display or standard derivation.
                else if (V && R) {
                    // Assuming R is Load Impedance and V is Line Voltage. 
                    // If Star: Vph = V/root3. I = Vph/R.
                    let Vph = V / root3;
                    I = Vph / R; 
                    P = root3 * V * I * pf;
                }
                else if (I && R) {
                    // If Star: Vph = I * R. VL = Vph * root3
                    let Vph = I * R;
                    V = Vph * root3;
                    P = root3 * V * I * pf;
                }
                else if (P && R) {
                    // P = 3 * I_ph^2 * R * PF (Total power)
                    // I = sqrt(P / (3 * R * PF))
                    I = Math.sqrt(P / (3 * R * pf));
                    let Vph = I * R;
                    V = Vph * root3;
                }
            }

            // Populate calculated object to map back to result fields
            calculated['p'] = P;
            calculated['v'] = V;
            calculated['i'] = I;
            calculated['r'] = R;

            // Render Results
            document.getElementById('res3').innerText = formatNum(calculated[missing[0]]);
            document.getElementById('res4').innerText = formatNum(calculated[missing[1]]);
        }

        function formatNum(num) {
            if (!num && num !== 0) return "Error";
            if (num > 10000) return num.toExponential(2);
            return parseFloat(num.toFixed(3)); // 3 decimal places
        }

        // Initialize
        updateDropdownLabels();
    </script>

</body>
</html>
